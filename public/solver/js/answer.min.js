function sumbitNotSatisfiedAnswer(){var a=$(".answer-rating").attr("answer_id");text=$("#notsattextbody").val(),$.ajax({url:"/notsatfisfiedwithanswer/",type:"POST",data:{answerId:a,text:text},success:function(){$("#submitnotsatbutton").remove(),$("#notsatisfiedmodalbody").html("Thanks for letting us know! You'll receive an email as confirmation.")}})}function sumbitNotSatisfiedPrepayment(){var a=$("div[prepayment_id]").attr("prepayment_id");text=$("#notsattextbody").val(),$.ajax({url:"/notsatfisfiedwithprepayment/",type:"POST",data:{prepaymentId:a,text:text},success:function(){$("#submitnotsatbutton").remove(),$("#notsatisfiedmodalbody").html("Thanks for letting us know! You'll receive an email as confirmation.")}})}function declineQuestion(a){confirm("Declining a question will remove you as the assigned tutor, freeing it up so that someone else can be the assigned tutor.")&&$.ajax({url:"/question/"+a+"/decline/",type:"POST",success:function(){window.location.href="/question/"+a}})}function deleteAnswer(a){confirm("Are you sure you want to remove this answer?")&&$.ajax({url:"/answer/"+a+"/delete/",type:"POST",success:function(){window.location.href="/"},error:function(){alert("This answer has already been bought or you are not authorized to delete this answer.")}})}function initRating(){function a(a){a=Math.round(2*a)/2;var c=parseInt(22*a*2);b.css("background-position","0px -"+c+"px")}var b=$(this),c=b.attr("rating"),d=b.attr("answer_id"),e=b.hasClass("editable"),f=c;a(f),e&&(b.mousemove(function(b){var c=$(this).parent().offset(),d=b.pageX-c.left+8;f=parseInt(d/20),a(f)}),b.mouseout(function(){a(c)}),b.click(function(e){var g=f;return $.post("/answer/"+d+"/rate/?rating="+g,function(d){c=parseFloat(d),b.attr("title",c+"/5"),a(g)}),e.preventDefault(),!1}))}function showCheckProgress(a){var b=$("div[answer_id="+a+"].answer div.plagiarism-check-results");b.css("display","block").empty();var c='<img class="progress" src="'+staticUrl+'img/progress.gif">';b.append(c)}function showCheckResults(a,b){var c=$("div[answer_id="+a+"].answer div.plagiarism-check-results");c.css("display","block").empty();var d=$('<span class="check-result"></span>');if(b.length){console.log(b),d.html(String(b.length)+" possible plagiarism sources have been found."),c.append(d),c.append("<br>");var e=parseInt(100*b[0].words_matched/b[0].query_words);return 0==e?(d.html("No plagiarism reference could be found on the internet. We believe the answer is genuine."),void c.html(d)):(d=$('<span class="check-result"></span>'),d.html("The closest source matches approximately "+String(e)+"% of this answer."),c.append(d),void(e<5&&(d=$('<span class="check-result"></span>'),d.html("This is a low matching percentage so it's probably not plagiarized."),c.append(d))))}return d.html("No plagiarism reference could be found on the internet. We believe the answer is genuine."),void c.html(d)}function showCheckError(a,b){var c=$("div[answer_id="+a+"].answer div.plagiarism-check-results");c.css("display","block").empty();var d=$('<span class="check-error"></span>');b?d.html(b):d.html("An error occurred while contacting the service. Please try again later."),c.html(d)}function checkPlagiarism(a){confirm("The fee for this is 0.75$ per check. It will let you know if there is any content on the internet or books that this material may have been plagiarized from. Proceed?")&&(showCheckProgress(a),$.ajax({url:"/answer/"+a+"/checkplagiarism/",type:"POST",success:function(b){"string"==typeof b&&(b=$.parseJSON(b)),null!=b.error?showCheckError(a,b.error):showCheckResults(a,b.results)},error:function(){showCheckError(a)}}))}function subscribeToQuestion(a){email=$("#txtEmailAddress").val(),$.ajax({url:"/question/"+a+"/subscribe/",type:"POST",data:{email:email},success:function(){$("#divNotifyHeader").html("When an answer is posted we'll be sure to notify you!")}})}$(document).ready(function(){$("form.filter, form.search").submit(function(){var a=$(this).serialize();return window.location.href=combineUrls(window.location.href,"?"+a),!1}),$("div.answer-rating").each(initRating)});